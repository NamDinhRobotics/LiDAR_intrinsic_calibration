# intrinsic_3d_lidar_camera_calibration
## Overview
This is a package for intrinsic calibration of a 3D LiDAR described in paper: 3D LiDAR Intrinsic Calibration and Automatic System for LiDAR to Camera Calibration. In experimental data, we show that it outperforms physics-based models for a spinning LiDAR. In [simulation](https://github.com/UMich-BipedLab/lidar_simulator), we show how this perspective can be applied to a solid state LiDAR.  

To run the code, place the test datasets in the opts.mat_path folder, and run the main.m!

* Authors: Bruce JK Huang, Chenxi Feng, Madhav Achar, Maani Ghaffari, and Jessy W. Grizzle
* Maintainer: [Bruce JK Huang](https://www.brucerobot.com/), brucejkh[at]gmail.com
* Affiliation: [The Biped Lab](https://www.biped.solutions/), the University of Michigan


This package has been tested under MATLAB 2019a and Ubuntu 16.04.
More detailed introduction will be updated in a week. Sorry for the inconvenience!


**[Issues]**
If you encounter _any_ issues, I would be happy to help. If you cannot find a related one in the existing issues, please open a new one. I will try my best to help! 

## Abstract
Periodic intrinsic and extrinsic (re-)calibrations are essential for modern
perception and navigation systems deployed on autonomous robots. To date, intrinsic
calibration models for LiDARs have been based on hypothesized physical mechanisms for
how a spinning LiDAR functions, resulting in anywhere from three to ten parameters to
be estimated from data. Instead we propose to abstract away from the physics of a
LiDAR type (spinning vs solid state, for example) and focus on the spatial geometry
of the point cloud generated by the sensor. This leads to a unifying view of
calibration. In experimental data, we show that it outperforms physics-based models
for a spinning LiDAR. In simulation, we show how this perspective can be applied to a
solid state LiDAR. We complete the paper by reporting on an open- source automatic
system for target-based extrinsic calibration from a LiDAR to a camera.


## Introduction Video
Please checkout the introduction [video](https://www.brucerobot.com/automatic-calibration). It highlights some importants keypoints in the paper!  

[<img src="https://github.com/UMich-BipedLab/LiDAR_intrinsic_calibration/blob/release_v1/figure/IntroVideo.png" width="960">](https://www.brucerobot.com/automatic-calibration)


## System Diagram Overview
This figure motivates the main contribution of the paper, a means of calibrating a LiDAR without modeling the physical mechanism itself. Top left: shows a simple physics-based calibration model for a spinning LiDAR. 
1. Top right: shows a similar model with more parameters, also for a spinning LiDAR. In the literature, the number of parameters can vary from three to 10.
2. Bottom left and bottom right show, respectively, an optical phased array solid-state LiDAR and a MEMS-based LiDAR. There are many design options and many manufacturing steps to fabricate these LiDAR. Is it necessary, or even possible, to parameterize all of them? This paper moves the attention to the geometry of the LiDAR's point cloud  and proposes that calibration can be achieved via shape-preserving transformations. 
3. In experiments, the proposed method outperforms the methods showed in top figures for spinning \lidarsN, and via simulation, we support that it may be used to calibrate a solid-state LiDAR as well.

<img src="https://github.com/UMich-BipedLab/LiDAR_intrinsic_calibration/blob/release_v1/figure/UnifyingCalibration.jpg" width="960">


## Results Quick View
### Induce 3-parameter perturbation model (N1),  6-parameter perturbation model (N2), and Sim(3) noise model (N3) for a spinning LiDAR in the [simulator](https://github.com/UMich-BipedLab/lidar_simulator).
<img src="https://github.com/UMich-BipedLab/LiDAR_intrinsic_calibration/blob/release_v1/figure/SimulationSpinning.png" width="960">

### Geometric uncertainty of a solid-state LiDAR by assuming the plane of the wafer is slightly warped.
<img src="https://github.com/UMich-BipedLab/LiDAR_intrinsic_calibration/blob/release_v1/figure/SimulationSSLiDAR.png" width="960">

### Experiments data collected using different numbers of targets in the calibration scene.
<img src="https://github.com/UMich-BipedLab/LiDAR_intrinsic_calibration/blob/release_v1/figure/ExpSpinning.png" width="640">


# Why important? 
Intrinsic calibration ensures that obtained measurements are meaningful and valid!


## Calibration Targets
Any **square** targets would be fine. The dimensions are assumed known.
note: You can place any number of targets with different size in different datasets.


## Required packages
Please download _matlab_utils_ from [here](https://github.com/UMich-BipedLab/matlab_utils).   
To automatic extract LiDAR targets, we use [LiDARTag](https://github.com/UMich-BipedLab/LiDARTag) package and its [message](https://github.com/UMich-BipedLab/LiDARTag_msgs).

## Dataset 
Please download point cloud mat files from [here](https://drive.google.com/drive/folders/11MN0pV5JspMyq1mpwfo-3T0KUyxeRMVP?usp=sharing) and put them into opts.mat_path folder.


## Running
To run the code, place the test datasets in the opts.mat_path folder, and run the main.m!


## Citations
The detail is described in: 
Jiunn-Kai Huang, Chenxi Feng, Madhav Achar, Maani Ghaffari, and Jessy W. Grizzle, "Global Unifying Intrinsic Calibration for Spinning and Solid-State LiDARs" ([arXiv](https://arxiv.org/abs/2012.03321))

```
@article{huang2020global,
  title={Global Unifying Intrinsic Calibration for Spinning and Solid-State LiDARs},
  author={Huang, Jiunn-Kai and Feng, Chenxi and Achar, Madhav and Ghaffari, Maani and Grizzle, Jessy W},
  journal={arXiv preprint arXiv:2012.03321},
  year={2020}
}
```
